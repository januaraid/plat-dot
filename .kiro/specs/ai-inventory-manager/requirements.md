# 要件仕様書

## 概要
plat-dot（プラットドット）は、AI機能を搭載した個人向け持ち物管理Webアプリケーションです。ユーザーが自宅にある持ち物を効率的にリスト化・整理でき、AI技術による商品名自動認識、複数フリマサイトでの価格比較、価格推移追跡などの高度な機能を提供します。基本機能は無料で利用可能で、AI機能は段階的な課金体系により必要に応じて利用できます。

## 要件

### 要件1: 基本アイテム管理機能
**ユーザーストーリー:** ユーザーとして、自分の持ち物をリスト化して管理したいので、アイテムの追加・編集・削除・検索ができるようにしたい

#### 受入条件
1. WHEN ユーザーが新しいアイテムを追加する THEN アイテム名、説明、カテゴリ、購入日、購入価格を入力できる
2. WHEN ユーザーがアイテム一覧を表示する THEN 全てのアイテムがリスト形式で表示される
3. WHEN ユーザーがアイテムを検索する THEN アイテム名、カテゴリ、説明で部分一致検索ができる
4. WHEN ユーザーがアイテムを編集する THEN 既存の情報を変更して保存できる
5. WHEN ユーザーがアイテムを削除する THEN 確認ダイアログの後にアイテムが完全に削除される
6. IF アイテム追加時に必須項目が未入力 THEN エラーメッセージを表示して保存を拒否する

### 要件2: フォルダ分類機能
**ユーザーストーリー:** ユーザーとして、持ち物を整理しやすくしたいので、カスタムフォルダを作成してアイテムを分類できるようにしたい

#### 受入条件
1. WHEN ユーザーが新しいフォルダを作成する THEN フォルダ名と説明を設定できる
2. WHEN ユーザーがアイテムをフォルダに移動する THEN ドラッグ&ドロップまたは選択メニューで移動できる
3. WHEN ユーザーがフォルダを表示する THEN そのフォルダ内のアイテムのみが表示される
4. WHEN ユーザーがフォルダを削除する THEN フォルダ内のアイテムは未分類状態に戻る
5. WHEN ユーザーがフォルダ階層を作成する THEN サブフォルダを3階層まで作成できる
6. IF フォルダ名が重複している THEN エラーメッセージを表示して作成を拒否する

### 要件3: 画像添付機能
**ユーザーストーリー:** ユーザーとして、アイテムを視覚的に管理したいので、各アイテムに画像を添付できるようにしたい

#### 受入条件
1. WHEN ユーザーがアイテムに画像を追加する THEN JPG、PNG、WEBP形式の画像をアップロードできる
2. WHEN ユーザーが複数の画像を追加する THEN 1つのアイテムに最大10枚まで画像を添付できる
3. WHEN ユーザーが画像を表示する THEN サムネイル表示とフルサイズ表示を切り替えられる
4. WHEN ユーザーが画像を削除する THEN 確認ダイアログの後に画像が削除される
5. WHEN ユーザーが画像の順序を変更する THEN ドラッグ&ドロップで画像の表示順を変更できる
6. IF アップロードファイルのサイズが10MBを超える THEN エラーメッセージを表示してアップロードを拒否する

### 要件4: AI商品名認識機能
**ユーザーストーリー:** ユーザーとして、商品名の入力を簡素化したいので、アップロードした画像からAIが商品名を自動で認識・提案してほしい

#### 受入条件
1. WHEN ユーザーが画像をアップロードする THEN AIが画像を解析して商品名の候補を3つまで提案する
2. WHEN ユーザーがAI提案を確認する THEN 提案された商品名から選択するか、手動で入力するかを選べる
3. WHEN AI認識が実行される THEN 処理中にローディング表示が出る
4. WHEN AI認識が完了する THEN 認識結果と信頼度スコアが表示される
5. WHEN ユーザーがAI提案を採用する THEN ワンクリックでアイテム名に反映される
6. IF AI認識に失敗した THEN 「認識できませんでした」メッセージを表示して手動入力を促す

### 要件5: AI価格比較機能
**ユーザーストーリー:** ユーザーとして、持ち物の現在価値を把握したいので、AIがメルカリなどのフリマサイトを横断検索して売価を表示してほしい

#### 受入条件
1. WHEN ユーザーが価格検索を実行する THEN メルカリ、ヤフオク、楽天ラクマの価格情報を取得する
2. WHEN 価格検索結果が表示される THEN 各サイトの最安値、平均価格、最高値が表示される
3. WHEN ユーザーが詳細を確認する THEN 商品ページへのリンクと出品者情報が表示される
4. WHEN 複数の類似商品が見つかる THEN 最も関連性の高い商品を優先して表示する
5. WHEN 価格情報を保存する THEN 検索日時と価格データがアイテム履歴に記録される
6. IF 該当商品が見つからない THEN 「該当商品が見つかりませんでした」メッセージを表示する

### 要件6: 定期価格追跡機能
**ユーザーストーリー:** ユーザーとして、持ち物の価値変動を追跡したいので、定期的な価格取得と推移グラフを確認できるようにしたい

#### 受入条件
1. WHEN ユーザーが価格追跡を有効にする THEN 週次、月次の自動価格更新スケジュールを設定できる
2. WHEN 定期価格取得が実行される THEN バックグラウンドで自動的に最新価格を取得する
3. WHEN 価格推移を表示する THEN 過去6ヶ月間の価格変動をグラフで表示する
4. WHEN 価格変動を通知する THEN 前回比20%以上の変動があった場合にユーザーに通知する
5. WHEN 価格履歴を確認する THEN 各取得日時の詳細な価格データを一覧表示する
6. IF 価格取得に連続して失敗する THEN ユーザーに通知してトラッキングを一時停止する

### 要件7: フリーミアム課金モデル
**ユーザーストーリー:** ユーザーとして、基本機能は無料で使いつつ、高度なAI機能は必要に応じて有料で利用したいので、段階的な課金体系を提供してほしい

#### 受入条件
1. WHEN 新規ユーザーが登録する THEN 20アイテムまでのAI機能を無料で利用できる
2. WHEN ユーザーが無料枠を超過する THEN 有料プランへのアップグレードを促すメッセージを表示する
3. WHEN ユーザーが有料プランに加入する THEN AI機能の利用制限が解除される
4. WHEN ユーザーが利用状況を確認する THEN 現在の使用量と残り枠をダッシュボードで表示する
5. WHEN 課金処理を実行する THEN セキュアな決済システムで月額サブスクリプションを処理する
6. IF 有料ユーザーが支払いに失敗する THEN 猶予期間後に無料プランに自動的にダウングレードする

### 要件8: ユーザー認証・管理機能
**ユーザーストーリー:** ユーザーとして、自分のデータを安全に管理したいので、セキュアなユーザー認証とプライバシー保護機能を利用したい

#### 受入条件
1. WHEN ユーザーがアカウント作成する THEN メールアドレスとパスワードで登録できる
2. WHEN ユーザーがログインする THEN 認証情報を検証してセッションを開始する
3. WHEN ユーザーがパスワードをリセットする THEN メール認証を経てパスワードを変更できる
4. WHEN ユーザーがデータをエクスポートする THEN 個人データをCSV形式でダウンロードできる
5. WHEN ユーザーがアカウント削除する THEN 確認手続き後に全データを完全削除する
6. IF ログイン試行が連続して失敗する THEN アカウントを一時的にロックしてセキュリティを保護する

### 要件9: レスポンシブデザイン・パフォーマンス
**ユーザーストーリー:** ユーザーとして、様々なデバイスで快適にアプリを利用したいので、レスポンシブデザインと高いパフォーマンスを提供してほしい

#### 受入条件
1. WHEN ユーザーがモバイルデバイスでアクセスする THEN タッチ操作に最適化されたUIが表示される
2. WHEN ユーザーがタブレットでアクセスする THEN 画面サイズに応じて適切なレイアウトが表示される
3. WHEN ページが読み込まれる THEN 初期表示が3秒以内に完了する
4. WHEN ユーザーが画像を表示する THEN 遅延読み込みで表示パフォーマンスを最適化する
5. WHEN オフライン状態になる THEN 基本的な閲覧機能がオフラインで利用できる
6. IF ネットワーク接続が不安定 THEN 適切なエラーメッセージと再試行オプションを表示する

### 要件10: データプライバシー・セキュリティ
**ユーザーストーリー:** ユーザーとして、個人の持ち物情報を安全に管理したいので、適切なセキュリティとプライバシー保護を実施してほしい

#### 受入条件
1. WHEN ユーザーデータが保存される THEN 全ての個人情報が暗号化される
2. WHEN 通信が行われる THEN HTTPSによる暗号化通信が使用される
3. WHEN ユーザーが画像をアップロードする THEN プライベートストレージに保存され、認証なしではアクセスできない
4. WHEN セッションがタイムアウトする THEN 自動的にログアウトされる
5. WHEN APIが呼び出される THEN 適切な認証トークンが必要となる
6. IF 不正なアクセスが検知される THEN セキュリティアラートが管理者に送信される